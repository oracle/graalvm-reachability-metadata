{
  "$id": "https://raw.githubusercontent.com/oracle/graalvm-reachability-metadata/master/schemas/metadata-library-index-schema-v1.0.0.json",
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "description": "Schema for metadata/<groupId>/<artifactId>/index.json. Each entry describes a metadata bundle for a range of library versions.",
  "type": "array",
  "minItems": 1,
  "items": {
    "type": "object",
    "additionalProperties": false,
    "required": [
      "module",
      "metadata-version",
      "tested-versions"
    ],
    "properties": {
      "module": {
        "$ref": "#/$defs/moduleCoordinate",
        "description": "Maven coordinates in the form '<groupId>:<artifactId>'."
      },
      "metadata-version": {
        "type": "string",
        "minLength": 1,
        "description": "Subdirectory name where the metadata files for this entry reside, e.g. '7.1.0.Final'."
      },
      "tested-versions": {
        "type": "array",
        "description": "Explicitly tested upstream library versions that this metadata is known to support.",
        "minItems": 1,
        "uniqueItems": true,
        "items": {
          "type": "string",
          "minLength": 1
        }
      },
      "test-version": {
        "type": "string",
        "minLength": 1,
        "description": "Overrides 'metadata-version' for use in test directories. This allows one metadata entry to share tests defined for a different version's metadata directory."
      },
      "latest": {
        "type": "boolean",
        "description": "Marks this entry as the latest/default metadata for currently supported versions."
      },
      "default-for": {
        "type": "string",
        "description": "Java regular expression describing the version range for which this entry should be used by default (e.g. '7\\\\.1\\\\..*')."
      },
      "override": {
        "type": "boolean",
        "description": "When true, expresses the intent to exclude outdated built-in metadata shipped with Native Image for the matched versions."
      },
      "skipped-versions": {
        "type": "array",
        "description": "Versions explicitly excluded from support, each with a reason.",
        "minItems": 1,
        "items": {
          "type": "object",
          "additionalProperties": false,
          "required": [ "version", "reason" ],
          "properties": {
            "version": {
              "type": "string",
              "minLength": 1
            },
            "reason": {
              "type": "string",
              "minLength": 1
            }
          }
        }
      }
    }
  },
  "$defs": {
    "moduleCoordinate": {
      "type": "string",
      "pattern": "^[^:]+:[^:]+$"
    }
  },
  "examples": [
    [
      {
        "metadata-version": "0.0.1",
        "module": "org.example:library",
        "tested-versions": [ "0.0.1", "0.0.2" ],
        "default-for": "0\\.0\\..*",
        "test-version": "0.0.1"
      },
      {
        "latest": true,
        "metadata-version": "1.0.0",
        "module": "org.example:library",
        "tested-versions": [ "1.0.0", "1.1.0" , "1.2.0"]
      },
      {
        "metadata-version": "1.19.0",
        "module": "io.opentelemetry:opentelemetry-exporter-logging",
        "tested-versions": [ "1.19.0" ],
        "override": true,
        "skipped-versions": [
          { "version": "1.0.5", "reason": "Known incompatible API change." }
        ]
      }
    ]
  ]
}
